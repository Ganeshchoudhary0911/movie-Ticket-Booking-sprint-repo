<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title
	th:text="${show != null and show.showId != null} ? 'Edit Show' : 'Add Show'">Show
	Form</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
	rel="stylesheet" crossorigin="anonymous" />
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
	rel="stylesheet" />
<style>
.required::after {
	content: " *";
	color: #dc3545
}
</style>
</head>
<body>
	<!-- Inline Navbar -->
	<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
		<div class="container-fluid">
			<a class="navbar-brand fw-semibold" th:href="@{/admin/dashboard}">Admin
				Panel</a>
			<button class="navbar-toggler" type="button"
				data-bs-toggle="collapse" data-bs-target="#nav">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div id="nav" class="collapse navbar-collapse">
				<ul class="navbar-nav me-auto">
					<li class="nav-item"><a class="nav-link"
						th:href="@{/admin/movies}">Movies</a></li>
					<li class="nav-item"><a class="nav-link"
						th:href="@{/admin/theatres}">Theatres</a></li>
					<li class="nav-item"><a class="nav-link active"
						th:href="@{/admin/shows}">Shows</a></li>
				</ul>
				<a class="btn btn-outline-light" th:href="@{/logout}"><i
					class="bi bi-box-arrow-right me-1"></i>Logout</a>
			</div>
		</div>
	</nav>

	<main class="container py-4">
		<div class="d-flex align-items-center justify-content-between mb-3">
			<h2 class="mb-0"
				th:text="${show != null and show.showId != null} ? 'Edit Show' : 'Add Show'">Add
				Show</h2>
			<a class="btn btn-secondary" th:href="@{/admin/shows}"> <i
				class="bi bi-arrow-left"></i> Back
			</a>
		</div>


		<form th:object="${show}"
			th:action="${show != null and show.showId != null} 
                     ? @{/admin/shows/{id}(id=${show.showId})} 
                     : @{/admin/shows}"
			method="post" class="row g-3">

			<!-- Hidden method override for PUT -->
			<input th:if="${show != null and show.showId != null}" type="hidden"
				name="_method" value="put" /> <input type="hidden"
				th:field="*{showId}" />


			<div class="col-12 col-md-6">
				<label class="form-label required">Movie</label> <select
					class="form-select" th:field="*{movieId}" required>
					<option value="" disabled
						th:selected="${show == null or show.movieId == null}">Select
						movie</option>
					<option th:each="m : ${movies}" th:value="${m.movieId}"
						th:text="${m.movieName}"></option>
				</select>

				<p class="text-danger small" th:if="${#fields.hasErrors('movieId')}"
					th:errors="*{movieId}"></p>
			</div>

			<div class="col-12 col-md-6">
				<label class="form-label required">Theatre</label> <select
					class="form-select" th:field="*{theatreId}" required>
					<option value="" disabled
						th:selected="${show == null or show.theatreId == null}">Select
						theatre</option>
					<option th:each="t : ${theatres}" th:value="${t.theatreId}"
						th:text="${t.theatreName}"></option>
				</select>

				<p class="text-danger small"
					th:if="${#fields.hasErrors('theatreId')}" th:errors="*{theatreId}"></p>
			</div>

			<div class="col-12 col-md-4">
				<label class="form-label required">Date</label> <input type="date"
					class="form-control" th:field="*{showDate}" required />

				<p class="text-danger small"
					th:if="${#fields.hasErrors('showDate')}" th:errors="*{showDate}"></p>
			</div>

			<div class="col-12 col-md-4">
				<label class="form-label required">Time</label> <input type="time"
					class="form-control" th:field="*{showTime}" required />

				<p class="text-danger small"
					th:if="${#fields.hasErrors('showTime')}" th:errors="*{showTime}"></p>
			</div>

			<div class="col-12">
				<button type="submit" class="btn btn-success">
					<i class="bi bi-save me-1"></i> <span
						th:text="${show != null and show.showId != null} ? 'Save Changes' : 'Create Show'">Create
						Show</span>
				</button>
				<a class="btn btn-outline-secondary ms-2" th:href="@{/admin/shows}">
					<i class="bi bi-x-circle me-1"></i> Cancel
				</a>
			</div>
		</form>
	</main>

	<footer class="text-center text-muted py-4">
		<small>&copy; <span
			th:text="${#dates.format(#dates.createNow(), 'yyyy')}"></span> Admin
			Portal
		</small>
	</footer>

	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
		crossorigin="anonymous"></script>
</body>
</html>
``
